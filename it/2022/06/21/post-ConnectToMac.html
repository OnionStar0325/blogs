<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>외부에 공개되어 있지 않은 Mac에 ssh 접속환경 만들기 | Onion &amp; Star Blog</title>
<meta name="generator" content="Jekyll v4.2.2">
<meta property="og:title" content="외부에 공개되어 있지 않은 Mac에 ssh 접속환경 만들기">
<meta property="og:locale" content="en_US">
<meta name="description" content="크롬북을 구매하고 나서, 생각보다 쾌적한 사용성과 기능에 만족을 하였지만, 태생적인 하드웨어의 한계로 인하여, 크롬북은 단말기의 역할 그리고 Jekyll 기반의 블로그 작성에만 사용하기로 결정했다. (결정적인 계기는 크롬북에 RDBMS를 설치하기에는 무리라고 생각되어서이다) 그래서 출장등으로 밖에 나와 있을 때에는 집에 있는 맥북에 SSH로 접속하여, 필요한 작업을 하기로 결정을 했다. 평소대로라면, 맥에 ssh포트를 열어두고, 공유기에서 포트포워딩을 했을텐데 크롬북이라는 특수성과 집에서 사용하고 있는 공유기에서 하기의 문제가 발생하였다. 집에 사용하는 공유기는 아파트에 기본으로 설치되어 있는 공유기인데 해당 공유기에서 포트포워딩을 설정하여도 맥으로 신호가 전달되지 않음.(이유를 찾지 못함) 크롬북의 리눅스 시스템은 한글입력을 지원하지 않고, 안드로이드 터미널앱은 구동이 불안정함 맥북에는 Jump Desktop 서버가 구동중이지만, 안드로이드 클라이언트 앱은 지원이 중단됨. 위와 같은 문제를 해결하기 위해, Terminal을 웹 환경에서 사용할 수 있게하는 ttyd를 집 내부에 구동시켜 놓고, 집에서 구동중인 Nginx의 reverse proxy 기능을 활용하여 크롬북에서 웹을 통하여 Mac에 접속하는 환경을 구축하였다.">
<meta property="og:description" content="크롬북을 구매하고 나서, 생각보다 쾌적한 사용성과 기능에 만족을 하였지만, 태생적인 하드웨어의 한계로 인하여, 크롬북은 단말기의 역할 그리고 Jekyll 기반의 블로그 작성에만 사용하기로 결정했다. (결정적인 계기는 크롬북에 RDBMS를 설치하기에는 무리라고 생각되어서이다) 그래서 출장등으로 밖에 나와 있을 때에는 집에 있는 맥북에 SSH로 접속하여, 필요한 작업을 하기로 결정을 했다. 평소대로라면, 맥에 ssh포트를 열어두고, 공유기에서 포트포워딩을 했을텐데 크롬북이라는 특수성과 집에서 사용하고 있는 공유기에서 하기의 문제가 발생하였다. 집에 사용하는 공유기는 아파트에 기본으로 설치되어 있는 공유기인데 해당 공유기에서 포트포워딩을 설정하여도 맥으로 신호가 전달되지 않음.(이유를 찾지 못함) 크롬북의 리눅스 시스템은 한글입력을 지원하지 않고, 안드로이드 터미널앱은 구동이 불안정함 맥북에는 Jump Desktop 서버가 구동중이지만, 안드로이드 클라이언트 앱은 지원이 중단됨. 위와 같은 문제를 해결하기 위해, Terminal을 웹 환경에서 사용할 수 있게하는 ttyd를 집 내부에 구동시켜 놓고, 집에서 구동중인 Nginx의 reverse proxy 기능을 활용하여 크롬북에서 웹을 통하여 Mac에 접속하는 환경을 구축하였다.">
<link rel="canonical" href="/it/2022/06/21/post-ConnectToMac.html">
<meta property="og:url" content="/it/2022/06/21/post-ConnectToMac.html">
<meta property="og:site_name" content="Onion &amp; Star Blog">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-06-21T00:00:00+09:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="외부에 공개되어 있지 않은 Mac에 ssh 접속환경 만들기">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-21T00:00:00+09:00","datePublished":"2022-06-21T00:00:00+09:00","description":"크롬북을 구매하고 나서, 생각보다 쾌적한 사용성과 기능에 만족을 하였지만, 태생적인 하드웨어의 한계로 인하여, 크롬북은 단말기의 역할 그리고 Jekyll 기반의 블로그 작성에만 사용하기로 결정했다. (결정적인 계기는 크롬북에 RDBMS를 설치하기에는 무리라고 생각되어서이다) 그래서 출장등으로 밖에 나와 있을 때에는 집에 있는 맥북에 SSH로 접속하여, 필요한 작업을 하기로 결정을 했다. 평소대로라면, 맥에 ssh포트를 열어두고, 공유기에서 포트포워딩을 했을텐데 크롬북이라는 특수성과 집에서 사용하고 있는 공유기에서 하기의 문제가 발생하였다. 집에 사용하는 공유기는 아파트에 기본으로 설치되어 있는 공유기인데 해당 공유기에서 포트포워딩을 설정하여도 맥으로 신호가 전달되지 않음.(이유를 찾지 못함) 크롬북의 리눅스 시스템은 한글입력을 지원하지 않고, 안드로이드 터미널앱은 구동이 불안정함 맥북에는 Jump Desktop 서버가 구동중이지만, 안드로이드 클라이언트 앱은 지원이 중단됨. 위와 같은 문제를 해결하기 위해, Terminal을 웹 환경에서 사용할 수 있게하는 ttyd를 집 내부에 구동시켜 놓고, 집에서 구동중인 Nginx의 reverse proxy 기능을 활용하여 크롬북에서 웹을 통하여 Mac에 접속하는 환경을 구축하였다.","headline":"외부에 공개되어 있지 않은 Mac에 ssh 접속환경 만들기","mainEntityOfPage":{"@type":"WebPage","@id":"/it/2022/06/21/post-ConnectToMac.html"},"url":"/it/2022/06/21/post-ConnectToMac.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
<link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Onion &amp; Star Blog">
</head>
<body>
<header class="site-header" role="banner">

  <div class="wrapper">
<a class="site-title" rel="author" href="/">Onion &amp; Star Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">외부에 공개되어 있지 않은 Mac에 ssh 접속환경 만들기</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-06-21T00:00:00+09:00" itemprop="datePublished">Jun 21, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>크롬북을 구매하고 나서, 생각보다 쾌적한 사용성과 기능에 만족을 하였지만, 태생적인 하드웨어의 한계로 인하여, 크롬북은 단말기의 역할 그리고 Jekyll 기반의 블로그 작성에만 사용하기로 결정했다. (결정적인 계기는 크롬북에 RDBMS를 설치하기에는 무리라고 생각되어서이다)
  그래서 출장등으로 밖에 나와 있을 때에는 집에 있는 맥북에 SSH로 접속하여, 필요한 작업을 하기로 결정을 했다. 평소대로라면, 맥에 ssh포트를 열어두고, 공유기에서 포트포워딩을 했을텐데 크롬북이라는 특수성과 집에서 사용하고 있는 공유기에서 하기의 문제가 발생하였다.</p>
<ul>
  <li>집에 사용하는 공유기는 아파트에 기본으로 설치되어 있는 공유기인데 해당 공유기에서 포트포워딩을 설정하여도 맥으로 신호가 전달되지 않음.(이유를 찾지 못함)</li>
  <li>크롬북의 리눅스 시스템은 한글입력을 지원하지 않고, 안드로이드 터미널앱은 구동이 불안정함</li>
  <li>맥북에는 Jump Desktop 서버가 구동중이지만, 안드로이드 클라이언트 앱은 지원이 중단됨. 
  위와 같은 문제를 해결하기 위해, Terminal을 웹 환경에서 사용할 수 있게하는 <a href="https://github.com/tsl0922/ttyd">ttyd</a>를 집 내부에 구동시켜 놓고, 집에서 구동중인 Nginx의 reverse proxy 기능을 활용하여 크롬북에서 웹을 통하여 Mac에 접속하는 환경을 구축하였다.</li>
</ul>

<h3 id="작업절차">작업절차</h3>
<ul>
  <li>Nginx에서 접속할 수 있고 Mac에 접속 가능한 PC에 ttyd설치(podman 이용)
    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>podman run -d -p 7681:7681 --name ttyd \
  docker.io/tsl0922/ttyd
</code></pre></div>    </div>
  </li>
  <li>ttyd 컨테이너에 환경설정
    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code># 컨테이너의 쉘 프롬프트 오픈
podman exec -it ttyd sh
</code></pre></div>    </div>
    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code># ssh client 설치
apt-get update
apt-get install ssh-client  
</code></pre></div>    </div>
    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code># root의 .bashrc에 하기내용 추가. 마지막 exit는 container 제어권 획득을 막기 위함
export LANG='ko_KR.UTF-8'
export LC_ALL='ko_KR.UTF-8'
ssh {mac account}@{mac 내부 IP 주소}
exit
</code></pre></div>    </div>
  </li>
  <li>nginx server configuration 설정
    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>server {
 ...

  location /{address}/ {
      proxy_pass   http://{ttyd container ip}:7681/$1;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_set_header X-Forwarded-Port $server_port;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_http_version 1.1;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection "upgrade";
  }
</code></pre></div>    </div>
  </li>
  <li>nginx syntax 검사 및 설정 반영
    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>nginx -t
service nginx reload
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="test">Test</h3>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://{dns or ip address}/{ttyd url}
</code></pre></div></div>
<p><img src="/assets/images/20220621-test_result.gif" alt="Test Image"></p>


  </div>
<a class="u-url" href="/it/2022/06/21/post-ConnectToMac.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Onion &amp; Star Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Onion &amp; Star Blog</li>
<li><a class="u-email" href="mailto:star@onionstar.co.kr">star@onionstar.co.kr</a></li>
</ul>
      </div>

      <div class="footer-col footer-col-2">
<ul class="social-media-list"><li><a href="https://github.com/OnionStar0325"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">OnionStar0325</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Github(OnionStar0325) Blog pages  </p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
